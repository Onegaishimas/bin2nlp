# Redis Configuration for bin2nlp Production
# Optimized for caching, rate limiting, and session storage

# Network settings
bind 0.0.0.0
port 6379
protected-mode no

# Memory settings
maxmemory 256mb
maxmemory-policy allkeys-lru

# Persistence settings
save 900 1    # Save if at least 1 key changed in 900 seconds
save 300 10   # Save if at least 10 keys changed in 300 seconds
save 60 10000 # Save if at least 10000 keys changed in 60 seconds

appendonly yes
appendfsync everysec

# Performance settings
tcp-keepalive 300
timeout 0

# Logging
loglevel notice
syslog-enabled no

# Database settings
databases 16

# Client settings
tcp-backlog 511
maxclients 10000

# Security settings
requirepass ""  # Set via environment in production

# Memory optimization
hash-max-ziplist-entries 512
hash-max-ziplist-value 64
list-max-ziplist-size -2
list-compress-depth 0
set-max-intset-entries 512
zset-max-ziplist-entries 128
zset-max-ziplist-value 64

# Performance tuning
lazyfree-lazy-eviction yes
lazyfree-lazy-expire yes
lazyfree-lazy-server-del yes
replica-lazy-flush yes